# 索引

## 一、索引分类

### 1.1 按数据结构分类

B+tree索引

Hash索引

Full-text索引

#### 1.1.1 B+tree索引

由B-tree演化而来，B-tree又由平衡二路查找树演化而来：

##### 1.1.1.1 B-tree：平衡多路查找树：

- 子节点的值大于父节点的左邻小于父节点的右舍；
- 所有叶子结点在同一层；
- 搜索复杂度为O(logdN)，其中d为B tree的度（degree）即：每一个节点的子节点的最大个数。通常大于100，所以即使是千万级的数据量，B tree的高度也依然维持在3-4层，保证了3-4次的I/O操作就能查询到目标值。

##### 1.1.1.2 B+tree

而**B+tree**，则在B-tree的基础上，将所有的叶节点之间按顺序连接起来，这样方便范围查找

###### B+tree与红黑树的比较：

红黑树：是一种**弱平衡二叉查找树**

没有一条路径会比其他路径长出2倍。**但虽然他有一些特性**，但他始终是二叉树，每个节点只有两个子节点，所以树的高度会比B+tree高出很多，因此也会多出很多次的I/O。

### 1.2 按物理存储分类

#### 1.2.1 聚簇索引

在B+tree的叶子结点的值包含该记录的所有内容，简化查询操作

#### 1.2.2 二级索引（辅助索引）

因为聚簇索引要求存放记录的所有内容，同一个记录不能在多处出现，所以一张表只能有一个聚簇索引（通常是在主键上），而其他的索引则将叶节点的值设置成主键，这样其他索引则需要通过两次检索，一次检索到主键值，然后根据这个主键值通过主键索引再检索到具体的记录内容。

> InnoDB存储引擎：要求必须有聚簇索引。一般在主键上建立聚簇索引，如果没有主键，则在表的第一个非空的唯一索引上建立，如果也没有，则InnoDB将自动生成一个隐式的子增id列，并在此列上建立聚簇索引。
>
> MyISAM存储引擎：不存在聚簇索引。他的叶子结点下存储的是记录的地址，根据地址再去取具体的值

### 按字段特性分类

主键索引

单列索引

普通索引

唯一索引

组合索引

全文索引

空间索引

## 优点

减少扫描数据行术，减少创建临时表的情况（不需要排序和分组，一般是排序和分组的时候会创建临时表），将随机I/O变为顺序I/O

**从而提高检索速度**

## 缺点

- 创建索引需要时间，如果不是建表的时候就创建了索引，而是后加的，那当表里已经有很多数据的时候，加索引可能会耗费很长时间。
- 插入、删除数据的时候需要维护索引
- 小表不需要，特大表会有以上问题。



